var UtilityContainer={getLocalizationAndEndpointUrl:function(){return $.ajax({url:$("meta[name=duka-localizations-and-endpoints-url]").attr("content"),cache:!0,async:!1})},getAllProducts:function(){var t=[];for(var e in Cookies.toObject())if(0===e.indexOf("_product_",0)){var i=JSON.parse(Cookies.get(e)),a=i.product,n=i.quantity,r=i.price;t.push({id:a,quantity:n,price:r})}return t},getNumberOfProductsInWishlist:function(){var t=0;for(var e in Cookies.toObject())0===e.indexOf("_wish_product_",0)&&(t+=JSON.parse(Cookies.get(e)).quantity);return t},getNumberOfProducts:function(){var t=0;for(var e in Cookies.toObject())0===e.indexOf("_product_",0)&&(t+=JSON.parse(Cookies.get(e)).quantity);return t},getProductsPrice:function(){for(var t=0,e=UtilityContainer.getAllProducts(),i=0,a=e.length;a>i;i++)t+=e[i].price*e[i].quantity;return t},removeAllProducts:function(){for(var t in Cookies.toObject())0===t.indexOf("_product_",0)&&Cookies.remove(t)},getShippingFromForm:function(){return{country:$("#shippingCountry").val(),postcode:$("#shippingPostcode").val(),province:$("#shippingProvince").val(),line1:$("#shippingAddress1").val(),line2:$("#shippingAddress2").val(),name:$("#shippingFirstname").val()+" "+$("#shippingLastname").val(),city:$("#shippingCity").val(),phone:$("#shippingTel").val()}},buyButton_to_Json:function(t){return{product:t.attr("data-product"),name:t.attr("data-name"),price:t.attr("data-price"),thumbnail:t.attr("data-thumbnail"),thumbnail_lg:t.attr("data-thumbnail_lg"),quantity:parseInt(t.attr("data-quantity")),link:t.attr("data-link"),description:t.attr("data-description")?t.attr("data-description"):""}},populateCountry:function(t){var e="/js/data/country-list."+t+".json",i="",a=$("#country");$.getJSON(e,function(t){$.each(t,function(t,e){i+="CA"==t?"<option value='"+t+"' selected>"+e+"</option>":"<option value='"+t+"'>"+e+"</option>"}),a.append(i)})},validateEmptyFields:function(t){for(var e=!0,i=0,a=t.length;a>i;i++)if(""==t[i].val()){e=!1;break}return e},validateEmail:function(t){var e=/^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/i;return e.test(t)},validatePostCode:function(t,e){return"CA"==e?t.match(/^[ABCEGHJKLMNPRSTVXY]{1}\d{1}[A-Z]{1} ?\d{1}[A-Z]{1}\d{1}$/i)?!0:!1:"US"==e?t.match(/^\d{5}(?:[-\s]\d{4})?$/)?!0:!1:!0},validateEmptyCart:function(){var t;return t=0===UtilityContainer.getProductsPrice()?!0:!1},addErrorClassToFields:function(t){for(var e=0,i=t.length;i>e;e++)""==t[e].val()&&(t[e].parent().addClass("has-error"),t[e].addClass("animated shake").bind("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){$(this).removeClass("animated"),$(this).removeClass("shake"),$(this).unbind()}))},addErrorClassToFieldsWithRules:function(t){t.parent().addClass("has-error"),t.addClass("animated shake").bind("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){$(this).removeClass("animated"),$(this).removeClass("shake"),$(this).unbind()})},addFadeOutUpClass:function(t){t.addClass("animated fadeOutUp").delay(1e3).queue(function(){$(this).addClass("hidden").clearQueue()})},removeErrorClassFromFields:function(t){for(var e=0,i=t.length;i>e;e++)""!=t[e].val()&&t[e].parent().hasClass("has-error")&&t[e].parent().removeClass("has-error")},getCheapestShippingMethod:function(t){for(var e=t.shipping.services,i=[],a=0,n=e.length;n>a;a++)i.push(e[a]);return i.sort(function(t,e){return t.price-e.price}),{fare:i[0].price,method:i[0].method}},getTaxes:function(t){var e=0,i=t.taxes.length;if(0!=i)for(var a=0;i>a;a++)e+=t.taxes[a].amount;return e.toFixed(2)},getShipmentTaxes:function(t,e){for(var i=0,a=0;a<e.shipping.services.length;a++)if(e.shipping.services[a].method==t&&0!=e.shipping.services[a].taxes.length)for(var n=0;n<e.shipping.services[a].taxes.length;n++)i+=e.shipping.services[a].taxes[n].amount;return i.toFixed(2)},getCartTaxes:function(t,e){var i=parseFloat(UtilityContainer.getTaxes(e)),a=parseFloat(UtilityContainer.getShipmentTaxes(t,e)),n=i+a;return n},getCartTotal:function(t,e){var i=parseFloat(UtilityContainer.getCartTaxes(t.method,e)),a=parseFloat(UtilityContainer.getCheapestShippingMethod(e).fare),n=parseFloat(UtilityContainer.getProductsPrice()),r=(i+a+n).toFixed(2);return r},setBadgeQuantity:function(){$(".cart_badge").text(UtilityContainer.getNumberOfProducts())},urlGetParameters:function(){var t=document.location.search.substr(1);if(t.length<1)return{};var e,i,a,n,r=t.split("&"),o={};for(e in r)r[e].indexOf("=")<1||(i=r[e].split("="),a=decodeURIComponent(i[0]),n=decodeURIComponent(i[1]),o[a]=n,n.indexOf(";")>-1&&(o[a]=n.split(";")));return o},urlAddParameters:function(t,e){var i={};if("object"==typeof t)i=t;else{if("string"!=typeof t||"undefined"==typeof e)return console.log("Invalid query parameters.");i[t]=e}var a,n=this.urlGetParameters();for(a in i)n[a]=i[a];document.location.search=this.urlBuildQuery(n)},urlRemoveParameters:function(t){t="string"==typeof t?[t]:t;var e=this.urlGetParameters();t.forEach(function(t,i,a){"undefined"!=typeof e[t]&&delete e[t]}),document.location.search=this.urlBuildQuery(e)},urlBuildQuery:function(t){var e=[];for(var i in t)"undefined"!=typeof t[i]&&null!=t[i]&&("object"==typeof t[i]&&(t[i]=t[i].join(";")),e.push(encodeURIComponent(i)+"="+encodeURIComponent(t[i])));return"?"+(e.length>1?e.join("&"):e[0])}},cartSliderContainer={behaviour:{buyButtonClick:function(){$("body").on("click",".buybutton",function(){cartSliderContainer.behaviour.addItem(UtilityContainer.buyButton_to_Json($(this))),cartSliderContainer.behaviour.storeItem(UtilityContainer.buyButton_to_Json($(this))),$("#empty-cart").addClass("hidden")})},addItem:function(t){var e=(parseInt(t.quantity)*parseFloat(t.price)).toFixed(2),i='<div class="very padded item animated fadeInUp" style="margin: 1rem auto;" data-product="'+t.product+'"data-quantity=1><div class="ui tiny left floated image"><img src="'+t.thumbnail_lg+'"/></div><div class="middle aligned content"><h4 class="ui header">'+t.name+'</h4><div class="meta"><span class="price" data-price="'+t.price+'">$'+e+'</span><i class="trash icon large pull-right close-button"></i></div><div class="content cart-content"><span>'+Localization.quantity+'</span><div class="ui input small"><input type="number" class="quantity" min="1" step="1" value="'+t.quantity+'" name="products['+t.product+'][quantity]"><input type="hidden" name="products['+t.product+'][id]" value="'+t.product+'"/> </div></div></div></div>';$(".cart-items-list [data-product='"+t.product+"']").length||$(".cart-items-list").append(i)},storeItem:function(t){if(void 0!=Cookies.get("_product_"+t.product)){var e=JSON.parse(Cookies.get("_product_"+t.product)).quantity+1;$("input[name='products["+t.product+"][quantity]']").attr("value",e),Cookies.set("_product_"+t.product,{product:t.product,name:t.name,price:t.price,thumbnail:t.thumbnail,thumbnail_lg:t.thumbnail_lg,quantity:e,link:t.link,description:t.description})}else Cookies.set("_product_"+t.product,t);UtilityContainer.setBadgeQuantity(),cartSliderContainer.behaviour.setQuantityCookie(),cartSliderContainer.view.setSubtotal()},loadItem:function(){var t=Cookies.toObject();for(var e in t)0===e.indexOf("_product_",0)&&($("#empty-cart").addClass("hidden"),cartSliderContainer.behaviour.addItem(JSON.parse(Cookies.get(e))))},deleteItem:function(){$(document).on("click",".close-button",function(){var t=$(this).closest(".animated").addClass("animated fadeOutUp");t.one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){$(this).remove(),0===UtilityContainer.getNumberOfProducts()?$("#empty-cart").removeClass("hidden"):null}),Cookies.remove("_product_"+$(this).closest(".animated").data("product")),UtilityContainer.setBadgeQuantity(),cartSliderContainer.view.setSubtotal(),cartSliderContainer.behaviour.setQuantityCookie()})},modifyQuantity:function(){$(".cart-items-list").on("change",".quantity",function(){var t=$(this).closest(".item"),e=t.find(".price");e.text("$"+(e.data("price")*$(this).val()).toFixed(2));var i=JSON.parse(Cookies.get("_product_"+t.data("product")));i.quantity=parseInt($(this).val()),Cookies.set("_product_"+t.data("product"),i),UtilityContainer.setBadgeQuantity(),cartSliderContainer.view.setSubtotal(),cartSliderContainer.behaviour.setQuantityCookie()})},setQuantityCookie:function(){var t=UtilityContainer.getNumberOfProducts();void 0==Cookies.get("quantityCart")||0===t?Cookies.set("quantityCart",btoa("0")):Cookies.set("quantityCart",btoa(t))}},view:{slideIn:function(){$(".view-cart, .buybutton, .close-cart").on("click",function(){$(".cart-drawer").sidebar("toggle")})},setSubtotal:function(){var t=UtilityContainer.getProductsPrice(),e="CAD $"+t.toFixed(2);if($("meta[name='user-currency-code'], meta[name='user-currency-rate']").length>0){var i=(t*parseFloat($("meta[name='user-currency-rate']").attr("content"))).toFixed(2);e+=" ("+$("meta[name='user-currency-code']").attr("content")+" "+i+")"}$(".subtotal").text(e)}},init:function(){var t=cartSliderContainer.behaviour,e=cartSliderContainer.view;e.setSubtotal(),e.slideIn(),UtilityContainer.setBadgeQuantity(),t.buyButtonClick(),t.loadItem(),t.deleteItem(),t.modifyQuantity(),t.setQuantityCookie()}},paymentOverlayContainer={cancelOrder:function(){$("body").on("click","#cancelOrder",function(){Cookies.remove("_current_order"),$("#cancelledOrder").fadeOut(),window.location.replace("/"),UtilityContainer.removeAllProducts()})},displayUnpaidOverlay:function(){var t=JSON.parse(Cookies.get("_current_order")),e='<div class="ui small modal text-center unpaid-modal"><i class="close icon"></i><div class="header">'+Localization.pending_order.replace(":command",t.id)+'</div><div class="content"><div class="description"><div class="ui header">'+Localization.what_to_do+'</div><a href="'+t.payment_url+'"><button class="ui button green" id="payOrder">'+Localization.pay_now+'</button></a><button class="ui button red" id="cancelOrder">'+Localization.cancel_order+"</button></div></div></div>";$("body").prepend(e),$(".small.unpaid-modal").modal("show")},displayCongratulateOverlay:function(t){var e='<div class="ui modal congratulate-modal payment_successful"><div class="header">'+Localization.payment_successful+'</div><div class="content"><div class="description"><div class="ui header">'+Localization.summary_below+"</div><p>"+Localization.summary_copy+'</p></div><br/><table class="ui striped table" style="margin: 0 auto"><tbody class="center aligned"><tr><td>'+Localization.order+"</td><td>#"+t.id+"</td></tr>"+this.renderAdditionalDetails(t)+'</tbody></table></div><div class="actions"><div class="ui black deny button">'+Localization.close+"</div></div></div>";$("body").prepend(e),$(".congratulate-modal").modal("show")},renderAddress:function(t,e){var i=null==t.line2?"":t.line2+"<br/>";return"<tr><td>"+e+"</td><td>"+t.name+"<br/>"+t.line1+"<br/>"+i+t.city+", "+t.province+", "+t.postcode+"<br/>"+t.country+"</td></tr>"},renderAdditionalDetails:function(t){return null!=t.shipping_address?this.renderAddress(t.shipping_address,Localization.shipping_address)+this.renderAddress(t.billing_address,Localization.billing_address)+"<tr><td>"+Localization.subtotal+"</td><td>$"+parseFloat(t.payment_details.subtotal).toFixed(2)+"</td></tr><tr><td>"+Localization.taxes+"</td><td>$"+parseFloat(t.payment_details.taxes).toFixed(2)+"</td></tr><tr><td>"+Localization.total+"</td><td>$"+parseFloat(t.payment_details.total).toFixed(2)+"</td></tr>":""},checkPendingOrders:function(){if(Cookies.get("_current_order")){var t=JSON.parse(Cookies.get("_current_order"));$.ajax({type:"GET",url:ApiEndpoints.orders.view.replace(":id",t.id).replace(":verification",t.verification),success:function(t){"pending"===t.status?this.displayUnpaidOverlay():"paid"===t.status?(this.displayCongratulateOverlay(t),window.ga&&ga.create&&GAEAnalytics.register(t),_paq&&piwikAnalytics.trackEcommerceOrder(t),UtilityContainer.removeAllProducts(),UtilityContainer.setBadgeQuantity(),Cookies.remove("_current_order")):Cookies.remove("_current_order")}.bind(this)})}},init:function(){var t=paymentOverlayContainer;t.cancelOrder(),t.checkPendingOrders()}};Vue.component("product-card",{template:"#product-card-template",props:{name:String,productId:Number,route:String,formatNumber:Number,image:String,thumbnail:String,thumbnailLg:String,description:String,products:Array,firstFormatPrice:Number,firstFormatReducedPrice:Number,firstFormatRebatePercent:String,brandSlug:String,brandName:String},data:function(){return{productFormat:""}}});var productFormatContainer={productWithFormat:function(t){var e='<span class="text-strikethrough">CAD $ '+t.find(":selected").data("price")+'</span><span id="product-price" class="strong text-danger">CAD $ '+t.find(":selected").data("reduced")+"</span>";$(".sub.header").text(e)},productWithoutFormat:function(t){$("#product-format-name").text(t.find(":selected").data("format")),$("#product-price").text("CAD $ "+t.find(":selected").data("price"))},updateBuybuttonAttributes:function(t){$(".buybutton").attr({"data-product":t.val(),"data-price":t.find(":selected").data("price"),"data-name":t.find(":selected").data("name"),"data-format":t.find(":selected").data("format")})},updateProductInformation:function(){var t=productFormatContainer;$("#product-format").on("change",function(){$(this).find(":selected").data("reduced")?t.productWithFormat($(this)):t.productWithoutFormat($(this)),t.updateBuybuttonAttributes($(this))})},init:function(){const t=productFormatContainer;t.updateProductInformation()}},productLayoutFavoriteContainer={fadeInFavoriteIcon:function(){self=productLayoutFavoriteContainer,$(".dense-product").hover(function(){$(this).children(".favorite-wrapper").fadeIn(),self.setPopupText($(this).children(".favorite-wrapper"))},function(){$(this).children(".favorite-wrapper").hide()})},setPopupText:function(t){$(t).hasClass("favorited")?$(t).attr("title",Localization.wishlist_remove):$(t).attr("title",Localization.wishlist_add)},setWishlistBadgeQuantity:function(){var t=UtilityContainer.getNumberOfProductsInWishlist();$(".wishlist_badge").text(t)},addToFavorite:function(){var t,e=productLayoutFavoriteContainer;$(".favorite-wrapper").on("click",function(){$(this).hasClass("favorited")?e.removeFromFavorite($(this),e):(t=UtilityContainer.buyButton_to_Json($(this).parent().find(".buybutton")),localStorage.setItem("_wish_product "+t.product,JSON.stringify(t)),$(this).addClass("favorited"),e.setWishlistBadgeQuantity())})},persistFavorite:function(){for(var t=0,e=localStorage.length;e>t;t++)if(0===localStorage.key(t).lastIndexOf("_wish_product",0))for(var i=0;i<$(".favorite-wrapper").length;i++)JSON.parse(localStorage.getItem(localStorage.key(t))).product===$(".favorite-wrapper")[i].dataset.product&&($(".favorite-wrapper")[i].className+=" favorited")},removeFromFavorite:function(t,e){t.removeClass("favorited"),localStorage.removeItem("_wish_product "+t.data("product")),e.setWishlistBadgeQuantity()},init:function(){var t=productLayoutFavoriteContainer;t.setPopupText(),t.addToFavorite(),t.persistFavorite(),t.fadeInFavoriteIcon(),t.setWishlistBadgeQuantity()}},productQuantityContainer={addQuantity:function(t,e){$(".qty-selector[data-action='add']").on("click",function(){t.val(parseInt(t.val())+1),e()})},removeQuantity:function(t,e){$(".qty-selector[data-action='remove']").on("click",function(){var i=parseInt(t.val());i>1&&t.val(parseInt(t.val())-1),e()})},updateBuyButton:function(){$(".buybutton").attr("data-quantity",$(".qty-selector-input").val())},init:function(){var t=productQuantityContainer;t.addQuantity($(".qty-selector-input"),t.updateBuyButton),t.removeQuantity($(".qty-selector-input"),t.updateBuyButton)}},checkoutContainer={validation:{validateFormFields:function(){var t=checkoutContainer,e={shippingFirstname:{identifier:"shippingFirstname",rules:[{type:"empty",prompt:Localization.validation_name}]},shippingLastname:{identifier:"shippingLastname",rules:[{type:"empty",prompt:Localization.validation_name}]},shippingAddress1:{identifier:"shippingAddress1",rules:[{type:"empty",prompt:Localization.validation_address_shipping}]},shippingCountry:{identifier:"shippingCountry",rules:[{type:"empty",prompt:Localization.validation_address_shipping}]},shippingProvince:{identifier:"shippingProvince",rules:[{type:"empty",prompt:Localization.validation_address_shipping}]},shippingCity:{identifier:"shippingCity",rules:[{type:"empty",prompt:Localization.validation_city_shipping}]},shippingPostcode:{identifier:"shippingPostcode",rules:[{type:"postalCode[shippingCountry]",prompt:Localization.validation_post_shipping}]},customer_email:{identifier:"customer_email",rules:[{type:"empty",prompt:Localization.validation_email},{type:"email",prompt:Localization.validation_valid_email}]},customer_phone:{identifier:"customer_phone",rules:[{type:"empty",prompt:Localization.validation_phone}]},billingFirstname:{identifier:"billingFirstname",rules:[{type:"empty",prompt:Localization.validation_name}]},billingLastname:{identifier:"billingLastname",rules:[{type:"empty",prompt:Localization.validation_name}]},billingAddress1:{identifier:"billingAddress1",rules:[{type:"empty",prompt:Localization.validation_address_billing}]},billingCountry:{identifier:"billingCountry",rules:[{type:"empty",prompt:Localization.validation_address_shipping}]},billingProvince:{identifier:"billingProvince",rules:[{type:"empty",prompt:Localization.validation_address_shipping}]},billingCity:{identifier:"billingCity",rules:[{type:"empty",prompt:Localization.validation_city_billing}]},billingPostcode:{identifier:"billingPostcode",rules:[{type:"postalCode[billingCountry]",prompt:Localization.validation_post_billing}]}};$(".form-checkout").form({fields:e,inline:!0,on:"blur",onSuccess:function(e){e.preventDefault(),t.view.dispatchButtonsActions(),$(".cart-items-list .close-button").fadeOut(),$(".cart-items-list .cart-content .input").addClass("disabled")}})}},view:{autofillBillingInformation:function(){var t=$("#shippingFirstname").val(),e=$("#shippingLastname").val(),i=$("#shippingAddress1").val(),a=$("#shippingCity").val(),n=$("#shippingPostcode").val();$(".form-checkout").form("set values",{billingFirstname:t,billingLastname:e,billingAddress1:i,billingCity:a,billingPostcode:n})},clearFields:function(t,e){t.find(e).val("")},dispatchButtonsActions:function(){var t=checkoutContainer;t.view.displayShipmentMethodsAndPriceInformation(),t.actions.shipmentMethodsAjaxCall(),$(".back-contact-info").on("click",function(e){e.preventDefault(),t.view.displayContactInformation(e),$(".cart-items-list .close-button").fadeIn(),$(".cart-items-list .cart-content .input").removeClass("disabled"),t.error.removeError()}),$(".next-payment-process").on("click",function(e){e.preventDefault();var i='<div class="ui page dimmer redirect-dimmer"><div class="content"><div class="center"><div class="ui text loader"><h3 class="ui header white">'+Localization.payment_redirect+"</h3></div></div></div></div>";$(i).appendTo("body"),$(".redirect-dimmer").dimmer("show"),t.actions.placeOrderAjaxCall()})},displayContactInformation:function(t){$(".priceInformation").fadeOut(300),$(".shippingMethod").fadeOut(300,function(){$(".contactInformation").fadeIn()}),t.stopPropagation(),t.stopImmediatePropagation()},displayShipmentMethodsAndPriceInformation:function(){var t=$(".contactInformation"),e=$(".shippingMethod"),i=$(".priceInformation");t.fadeOut(300,function(){$(".shippingMethod .loadable-segment, .priceInformation .loadable-segment").addClass("loading"),e.show(0,function(){$(this).removeClass("hidden animated fadeInLeft").addClass("animated fadeInLeft")}),i.show(0,function(){$(this).removeClass("hidden animated fadeInLeft").addClass("animated fadeInLeft")})})},fadeInBillingInformation:function(){var t=checkoutContainer;$(".billing-checkbox").checkbox({onUnchecked:function(){$(".billingInformation").hide().removeClass("hidden").fadeIn(400),t.view.clearFields($(".billingInformation"),"input:text")},onChecked:function(){$(".billingInformation").fadeOut(300,function(){$(this).delay(300).addClass("hidden")})}})},fetchEstimate:function(t){var e=checkoutContainer;$("#shippingMethod-table-tbody").empty();for(var i=0,a=t.shipping.services.length;a>i;i++){var n=null!=t.shipping.services[i].delivery?t.shipping.services[i].delivery:" - ",r="<tr data-service='"+t.shipping.services[i].method+"'><td>"+t.shipping.services[i].name+"</td><td>"+n+"</td><td>$"+t.shipping.services[i].price.toFixed(2)+"</td><td><input type='radio' name='shipping' class='shipping_method' data-taxes='"+e.actions.getShipmentTaxes(t.shipping.services[i].method,t)+"' data-cost='"+t.shipping.services[i].price.toFixed(2)+"' data-value='"+t.shipping.services[i].method+"' value='"+btoa(JSON.stringify(t.shipping.services[i]))+"' ></td>";$("#shippingMethod-table-tbody").append(r)}$(".shippingMethod .segment").removeClass("loading"),e.bootstrap.selectDefaultShipmentMethod()},fetchPayment:function(t){var e=UtilityContainer.getProductsPrice().toFixed(2),i=$("input:radio.shipping_method:checked").data("cost"),a=checkoutContainer.actions.getTaxes(t)+parseFloat($("input:radio.shipping_method:checked").data("taxes")),n=parseFloat(e)+parseFloat(i)+parseFloat(a);$("#price_subtotal").text("$"+e),$("#price_transport").text("$"+i),$("#price_taxes").text("$"+a.toFixed(2)),$("#price_total").text("$"+n.toFixed(2)),$(".priceInformation .segment").removeClass("loading")},setInternationalFields:function(t){t.map(function(t){t.on("change",function(){"CA"!=$(this).val()?($(this).parent().next().addClass("disabled"),$(this).parent().next().find("select").attr("disabled",!0)):($(this).parent().next().removeClass("disabled"),$(this).parent().next().find("select").attr("disabled",!1))})})},updatePayment:function(t){var e,i,a,n=parseFloat(UtilityContainer.getProductsPrice()).toFixed(2);$(".shipping_method").on("change",function(){e=$(this).data("cost"),i=checkoutContainer.actions.getTaxes(t)+parseFloat($(this).data("taxes")),a=parseFloat(n)+parseFloat(e)+parseFloat(i),$("#price_subtotal").text("$"+n),$("#price_transport").text("$"+e),$("#price_taxes").text("$"+i.toFixed(2)),$("#price_total").text("$"+a.toFixed(2))})}},actions:{createOrdersCookie:function(t){var e=t.id,i=t.verification,a=t.payment_details.payment_url;Cookies.set("_current_order",JSON.stringify({id:e,verification:i,payment_url:a}))},getShipmentTaxes:function(t,e){for(var i=0,a=0;a<e.shipping.services.length;a++)if(e.shipping.services[a].method==t&&0!=e.shipping.services[a].taxes.length)for(var n=0;n<e.shipping.services[a].taxes.length;n++)i+=e.shipping.services[a].taxes[n].amount;return i.toFixed(2)},getTaxes:function(t){var e=0,i=t.taxes.length;if(0!=i)for(var a=0;i>a;a++)e+=t.taxes[a].amount;return parseFloat(e)},placeOrderAjaxCall:function(){$.ajax({method:"POST",url:ApiEndpoints.placeOrder,data:$("#cart_form").serialize(),cache:!1,success:function(t){try{var e=checkoutContainer;e.actions.createOrdersCookie(t),history.pushState({data:t},"Checkout ","/cart"),window.location.replace(t.payment_details.payment_url)}catch(i){checkoutContainer.error.displayError(),mixpanel&&mixpanelAnalytics.registerError(i)}},error:function(){checkoutContainer.error.displayError()}})},shipmentMethodsAjaxCall:function(){$.ajax({type:"POST",url:ApiEndpoints.estimate,data:{email:$("#customer_email").val(),shipping:{},products:UtilityContainer.getAllProducts(),shipping_address:UtilityContainer.getShippingFromForm()},success:function(t){try{checkoutContainer.view.fetchEstimate(t),checkoutContainer.view.fetchPayment(t),checkoutContainer.view.updatePayment(t)}catch(e){checkoutContainer.error.displayError(),mixpanel&&mixpanelAnalytics.registerError(e)}},error:function(t,e){self.error.displayError()}})}},error:{displayError:function(){checkoutContainer.error.removeError();var t=$(".shippingMethod .loadable-segment, .priceInformation .loadable-segment");t.removeClass("loading"),t.find("table").hide(),t.prepend('<div class="error-messages"><h3 class="ui header center aligned red error-message">'+Localization.error_occurred+'</h3><h5 class="ui header center aligned error-message">'+Localization.error_persist+"</h5></div>")},removeError:function(){var t=$(".shippingMethod .loadable-segment, .priceInformation .loadable-segment");t.addClass("loading"),t.find("table").show(),t.find(".error-messages").remove()}},bootstrap:{selectDefaultShipmentMethod:function(){for(var t=["DOM.EP","USA.TP","INT.TP"],e=$("input[name=shipping]"),i=0,a=e.length;a>i;i++)-1!=t.indexOf(e[i].dataset.value)&&(e[i].checked=!0)}},init:function(){var t=checkoutContainer;t.validation.validateFormFields(),t.view.fadeInBillingInformation(),t.view.setInternationalFields([$("#shippingCountry"),$("#billingCountry")]),$(".shipment-trigger").on("click",function(e){$(".billing-checkbox").checkbox("is checked")&&t.view.autofillBillingInformation(),e.preventDefault()})}},semanticInitContainer={module:{initDropdownModule:function(){$(".ui.dropdown").dropdown(),$(".ui.dropdown").on("click",function(){var t=$(this).data("action")||"activate";$(this).dropdown({action:t})})},initRatingModule:function(){$(".ui.rating").rating()},initPopupModule:function(){$(".popup").popup()},initCheckboxModule:function(){$(".ui.checkbox").checkbox()},initAccordionModule:function(){$(".ui.accordion").accordion()}},behaviors:{closeDimmer:function(){$(".close-dimmer").on("click",function(){$(".dimmer").dimmer("hide")})}},rules:{postalCode:function(){$.fn.form.settings.rules.postalCode=function(t,e){return document.getElementById("checkboxSuccess").checked&&"billingCountry"==e?!0:"CA"===$("#"+e).val()?t.match(/^[ABCEGHJKLMNPRSTVXY]{1}\d{1}[A-Z]{1} ?\d{1}[A-Z]{1}\d{1}$/i)?!0:!1:"US"===$("#"+e).val()?t.match(/^\d{5}(?:[-\s]\d{4})?$/)?!0:!1:!0}}},init:function(){var t=semanticInitContainer,e=t.module,i=t.behaviors,a=t.rules;e.initDropdownModule(),e.initRatingModule(),e.initPopupModule(),e.initCheckboxModule(),e.initAccordionModule(),i.closeDimmer(),a.postalCode()}},categoryContainer={searchParameters:{page:1,per_page:8,order:"relevance",min_price:null,max_price:null,brands:[],categories:[]},blurBackground:function(){$(".category-header").blurjs({source:".category-header"})},itemsPerPage:function(){$(".items-per-page .item").on("click",function(){categoryContainer.addDimmer(),UtilityContainer.urlAddParameters("per_page",$(this).data("sort"))}),$("#items-per-page-box").dropdown("set selected",this.searchParameters.per_page)},sortBy:function(){$(".sort-by .item").on("click",function(){categoryContainer.addDimmer(),UtilityContainer.urlAddParameters("order",$(this).data("sort"))}),$(".sort-by .item").each(function(t,e){return $(e).data("sort")==categoryContainer.searchParameters.order?($("#sort-by-box").dropdown("set selected",$(e).data("sort")),!1):void 0})},price:function(){$("#price-update").on("click",function(){categoryContainer.addDimmer(),UtilityContainer.urlAddParameters({min_price:$("#min-price").val(),max_price:$("#max-price").val()})}),this.searchParameters.min_price&&$("#min-price").val(this.searchParameters.min_price),this.searchParameters.max_price&&$("#max-price").val(this.searchParameters.max_price)},categories:function(){this.updateFilterList($("#refine-by-category"),"categories")},brands:function(){this.updateFilterList($("#refine-by-brand"),"brands")},updateFilterList:function(t,e){t.find(".item").on("change",{filter:e||"brands"},function(t){t.stopPropagation();var e=$(this).data("filter"),i=(categoryContainer.searchParameters[t.data.filter],$(this));i.prop("checked")?categoryContainer.addFilter(t.data.filter,e):categoryContainer.removeFilter(t.data.filter,e)}),t.find(".item").each(function(){$(this).prop("checked",categoryContainer.searchParameters[e].indexOf(""+$(this).data("filter"))>-1),$(this).prop("checked")&&categoryContainer.addTag($(this))})},addTag:function(t){var e='<div class="item"><a class="ui grey tag label">'+t.data("name")+'<i class="icon remove right floated" data-id="'+t.data("filter")+'" data-type="'+t.data("type")+'"></i></a></div>';$(".tags-list").append(e)},tags:function(){$(".tags-list .item .remove").on("click",function(){categoryContainer.removeFilter($(this).data("type"),$(this).data("id"))})},addFilter:function(t,e){this.searchParameters[t].push(e),this.updateFilters(t)},removeFilter:function(t,e){var i=this.searchParameters[t],a=[];if(i.length>1)for(var n in i)i[n]!=e&&a.push(i[n]);this.searchParameters[t]=a,this.updateFilters(t)},updateFilters:function(t){var e=this.searchParameters[t];if(e.sort(function(t,e){return t-e}),e.length>0){var i=e.length>1?e.join(";"):e[0];categoryContainer.addDimmer(),UtilityContainer.urlAddParameters(t,i)}else UtilityContainer.urlRemoveParameters(t)},retrieveSearchParameters:function(){var t=UtilityContainer.urlGetParameters();for(var e in t)this.searchParameters[e]=t[e],["brands","categories"].indexOf(e)>-1&&"object"!=typeof t[e]&&(this.searchParameters[e]=[t[e]])},toggleTagsList:function(){$(".tags-list").children().size()>0?$(".tags-list").parent().removeClass("hidden"):""},localizeDimmer:function(){$(".loading-text").text(Localization.loading)},addDimmer:function(){var t='<div class="ui page dimmer loading-dimmer"><div class="content"><div class="center"><div class="ui text loader"><h1 class="ui header loading-text white"></h1></div></div></div>';$("body").append(t),categoryContainer.localizeDimmer(),$(".ui.dimmer.loading-dimmer").dimmer("show")},init:function(){var t=categoryContainer;t.retrieveSearchParameters(),t.itemsPerPage(),t.sortBy(),t.price(),t.categories(),t.brands(),t.tags()}},wishlistLogicContainer={createWishlistElement:function(t){var e=wishlistLogicContainer,i='<div class="item list-layout-element"><div class="ui tiny image"><img src='+t.thumbnail_lg+'></div><div class="middle aligned content"><div class="header"><a href='+t.link+">"+t.name+'</a></div><div class="description"><p>'+t.description+"</p><h5> $ "+parseFloat(Math.round(100*t.price)/100).toFixed(2)+'</h5></div><div class="extra"><button class="ui right floated button green buybutton"data-product="'+t.product+'"data-price="'+t.price+'"data-thumbnail="'+t.thumbnail+'"data-thumbnail_lg="'+t.thumbnail_lg+'"data-name="'+t.name+'"data-description="'+t.description+'"data-quantity="'+t.quantity+'">Add to cart </button></button><button class="ui right floated button inverted red removeFavoriteButton" data-product="'+t.product+'">Remove from wishlist</button></div></div></div><hr/>';e.localizeWishlistButton(),$(".list-layout-element-container").append(i)},renderWishlist:function(){for(var t=wishlistLogicContainer,e=0,i=localStorage.length;i>e;e++)0===localStorage.key(e).lastIndexOf("_wish_product",0)&&t.createWishlistElement(JSON.parse(localStorage.getItem(localStorage.key(e))))},localizeWishlistButton:function(){$(".list-layout-element .buybutton").text(Localization.add_cart),$(".list-layout-element .removeFavoriteButton").text(Localization.wishlist_remove)},removeWishlistElement:function(){$(".list-layout-element-container").on("click",".removeFavoriteButton",function(){UtilityContainer.addFadeOutUpClass($(this).closest(".list-layout-element")),UtilityContainer.addFadeOutUpClass($(this).closest(".list-layout-element").next()),localStorage.removeItem("_wish_product "+$(this).data("product")),wishlistContainer.setNumberOfProductsInHeader(),productLayoutFavoriteContainer.setWishlistBadgeQuantity()})},init:function(){var t=wishlistLogicContainer;wishlistContainer.init(),t.renderWishlist(),t.removeWishlistElement()}},wishlistContainer={setNumberOfProductsInHeader:function(){var t="";t+=0==UtilityContainer.getNumberOfProductsInWishlist()||1==UtilityContainer.getNumberOfProductsInWishlist()?UtilityContainer.getNumberOfProductsInWishlist()+"  item ":UtilityContainer.getNumberOfProductsInWishlist()+"  items ",$("#quantity-wishlist").text(t)},init:function(){var t=wishlistContainer;t.setNumberOfProductsInHeader()}};!function(t,e,i){Vue.config.debug=!0,i(e).ready(function(){new Vue({el:".duka-container"}),i.ajaxSetup({headers:{"X-CSRF-TOKEN":i('meta[name="csrf-token"]').attr("content"),
locale:i("html").attr("lang")}});var t=UtilityContainer.getLocalizationAndEndpointUrl().responseJSON;Localization=t.Localization,ApiEndpoints=t.ApiEndpoints,semanticInitContainer.init(),checkoutContainer.init(),cartSliderContainer.init(),categoryContainer.init(),paymentOverlayContainer.init(),productLayoutFavoriteContainer.init(),productFormatContainer.init(),productQuantityContainer.init(),wishlistLogicContainer.init()})}(window,window.document,jQuery,void 0);